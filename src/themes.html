<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Urbanist:ital,wght@0,100..900;1,100..900&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css"
      integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      href="https://unpkg.com/fullcalendar@5.10.2/main.css"
      rel="stylesheet"
    />
    <script src="https://unpkg.com/fullcalendar@5.10.2/main.js"></script>
    <link rel="stylesheet" href="./sass/main.scss" />
  </head>
  <body>
    <load href="partials/study/header.html" />
    <load href="partials/themes/themes.html" />
    <load href="partials/footer.html" />
    <script type="module" src="/main.js"></script>
    <script type="module" src="./js/mobile-menu.js"></script>
    <script>
      const product = [
        {
          id: 0,
          image: 'img/physics.png',
          title: 'Definition of physics and its role in science',
        },
        {
          id: 1,
          image: 'img/physics.png',
          title: 'Basic physical quantities and units of measurement',
        },
        {
          id: 2,
          image: 'img/physics.png',
          title: 'Methods of scientific investigation',
        },
        {
          id: 3,
          image: 'img/kinematics.png',
          title: 'kinematics: Mechanical movements',
        },
        {
          id: 4,
          image: 'img/kinematics.png',
          title: 'kinematics: Trajectory and movement vector',
        },
        {
          id: 5,
          image: 'img/kinematics.png',
          title: 'kinematics: Velocity',
        },
        {
          id: 6,
          image: 'img/kinematics.png',
          title: 'kinematics: Acceleration',
        },
        {
          id: 7,
          image: 'img/kinematics.png',
          title: 'kinematics: Uniform rectilinear motion',
        },
        {
          id: 8,
          image: 'img/kinematics.png',
          title: 'kinematics: Equal-variable rectilinear motion',
          text: 'Types of movement: uniform and equally accelerated.',
        },
        {
          id: 9,
          image: 'img/dynamics.png',
          title: 'Dynamics: Newton`s Laws',
        },
      ];

      const categories = [...product];

      document.getElementById('searchBar').addEventListener('keyup', e => {
        const searchData = e.target.value.toLowerCase();
        const filteredData = categories.filter(item => {
          return item.title.toLowerCase().includes(searchData);
        });
        currentItem = 3; // Reset current item count for new search
        displayItem(filteredData);
      });

      let currentItem = 9;

      const displayItem = (items, loadMore = false) => {
        const list = items
          .slice(0, currentItem)
          .map(item => {
            return `<li class="themes__item">
                      <img src=${item.image} alt="themes img" class="themes__img">
                      <h2 class="themes__title">${item.title}</h2>
                      <a href="#" class="themes__link">Start learn</a>
                    </li>`;
          })
          .join('');

        if (loadMore) {
          document.getElementById('root').innerHTML += list;
        } else {
          document.getElementById('root').innerHTML = list;
        }
      };

      displayItem(categories);

      document.getElementById('load-more').addEventListener('click', () => {
        currentItem += 3;
        const displayedItems = Array.from(
          document.querySelectorAll('.themes__item')
        ).map(item => item.querySelector('.themes__title').textContent);
        const newItems = categories.filter(
          item => !displayedItems.includes(item.title)
        );
        displayItem(newItems, true);
      });
    </script>
  </body>
</html>
